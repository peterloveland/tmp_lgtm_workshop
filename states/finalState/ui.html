<!--    THIS IS THE UI OF THE FIGMA PLUGIN.
        IT CONNECTS TO THE OPENAI API.
        WHEN WE RECEIVE A MESSAGE FROM THE BACK-END, WE CAN USE IT TO UPDATE THE UI.
        WE UPDATE THE FIGMA UI BY SENDING MESSAGES TO CODE.TS like: "parent.postMessage({ pluginMessage: { type: 'INSERT MESSAGE HERE AS A STRING' } }, '*')"
-->

<!-- <style>
  .ui-container {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
</style>

<div class="ui-container">
  <textarea id="prompt-text">Generate content for a sample issue about React</textarea>
  <button id="submit" type="button">Submit</button>
  <p id="parsed">No response yet</p>
  <button id="ping">Ping</button>
</div>

<script>
  // Listen for messages from the back-end
  onmessage = (event) => {
    const { type, message, isLoading } = event.data.pluginMessage

    // If we receive an event of type "pong", show an alert.
    if (type === 'pong') {
      alert("Pong")
    }

    if (type === 'set_loading') {
      document.getElementById('submit').innerText = isLoading ? 'Generatingâ€¦' : 'Submit'
    }

    if (type === 'parsed_response') {
      document.getElementById('parsed').innerText = message ? JSON.stringify(message) : ''
    }


    // here we listen to the message from the back-end. This is looking for a message with the type "update-ui"
    if (type === 'update-ui') {
      console.log('Received message from back-end:', type)
    }
  }

  // Here we list for the click events on the buttons. You could do this much nicer in React.
  document.getElementById('submit').onclick = () => {
    const prompt = document.getElementById('prompt-text').value
    // We need to send a message to Figma itself, we do that with parent.postMessage
    parent.postMessage({ pluginMessage: { type: 'generate-ai', prompt } }, '*')
  }

  document.getElementById('ping').onclick = () => {
    parent.postMessage({ pluginMessage: { type: 'ping' } }, '*')
  }

</script> -->